
/* 
The first implementation
• reads the all lines from the keyboard,
• stores all the lines in the core with each word stored as a sequence of characters,
• circularly shifts all the lines and stores them,
• alphabetizes the circularly shifted lines, and then
• displays the results on the screen. */
#include "assignment1.h"

void InputFilter::inputfunction(string inputKeyword) { 
    while (cin >> inputKeyword)
    {
        line.vs.push_back(inputKeyword); // Add all keyword into L struct line by line
        if (getchar() == '\n')
        {
            vectorLine.push_back(line); // In Empty space, input all lines into vectorLine
            //cout << "Next lines will be sorted separately with previous contents " << endl;

            line.vs.clear();  // When Enterkey is twiced ,Clear all of information in L.vs
        }
    }
    for (int i = 0; i < vectorLine.size(); i++) // Without line change, count how many contents in vectorLine 
    {
        for (int j = 0; j < vectorLine[i].vs.size(); j++) // How many keywords in the line 
        {
            keywords mywords = {i,j}; // i lines j keywords 
            // cout << mywords.line_pos << " and " << mywords.keyword_pos << " Wow " << endl; 
            vectorKeyword.push_back(mywords); // add the keyword into ..
        }
    }
}

void Shift_Alphabet::aftercircularshifting() {
    for (int i = 0; i < vectorKeyword.size(); i++) // How many lines ..
    {
        int line_pos = vectorKeyword[i].line_pos;
        int keyword_pos = vectorKeyword[i].keyword_pos;
        int vs_sz = (int)vectorLine[line_pos].vs.size();
        int count = 0; 
        
        // cout << vs_sz << " <-- size check " << endl;
        
        for (int j = keyword_pos; j < vs_sz; j++) // How many keyword in the line 
        {
            count++;
            cout << vectorLine[line_pos].vs[j] ;
            if(count == vs_sz) 
            {
                cout << "" << endl;
            }
            else 
            {
                cout << " " ;
            }
        }
        for (int j = 0; j < keyword_pos; j++)
        {
            count++;
            cout << vectorLine[line_pos].vs[j];

            if(count == vs_sz) 
            {
                cout << "" << endl;
            }
            else 
            {
                cout << " ";
            }
        }
    }
}

// This function is to use at third parameter at sort in main function 
// sort(first, second , circularshift function) 
// We are going to sort using this parameter
bool Filter_cshift(const keywords &a, const keywords &b)  {
    all_lines First, Second;
    int length = 0;

    for (int i = a.keyword_pos; i < vectorLine[a.line_pos].vs.size(); i++)
    {
        First.vs.push_back(vectorLine[a.line_pos].vs[i]);
    }
    for (int i = 0; i < a.keyword_pos; i++)
    {
        First.vs.push_back(vectorLine[a.line_pos].vs[i]);
    }

    for (int i = b.keyword_pos; i < vectorLine[b.line_pos].vs.size(); i++)
    {
        Second.vs.push_back(vectorLine[b.line_pos].vs[i]);
    }
    for (int i = 0; i < b.keyword_pos; i++)
    {
        Second.vs.push_back(vectorLine[b.line_pos].vs[i]);
    }

    if((int)First.vs.size() < (int)Second.vs.size()) {
        length = (int)First.vs.size();
    }
    else {
        length = (int)Second.vs.size();
    }
    // Switch Postions again and again.. 
    for (int i = 0; i < length; i++)
    {
        if (First.vs[i] != Second.vs[i])
        {
            return First.vs[i] < Second.vs[i];
        }
    }
    return First.vs.size() < Second.vs.size();
}

int main()
{
    cout << " Please type lines again, If you are done, type CTRL + D " << endl;
    string inputKeyword;
    //compare sorter;
    InputFilter KS;
    Shift_Alphabet BB;
    //Input Filter 
    KS.inputfunction(inputKeyword);
    // Circular Shift Filter 
    sort(vectorKeyword.begin(), vectorKeyword.end(), Filter_cshift);
    cout << '\n' << "Sorted all_liness below " << '\n' << endl; 
    //Alphabetizer and Output Filter 
    BB.aftercircularshifting();

    return 0;
}
